function copyToClipboard(e){var t=$("<input>");$("body").append(t),t.val(e).select(),document.execCommand("copy"),t.remove()}function dropEnter(e){e.stopPropagation(),e.preventDefault(),dropZone.addClass("hover")}function dropLeave(){dropZone.removeClass("hover")}function doDrop(e){e.stopPropagation(),e.preventDefault(),dropZone.removeClass("hover");var t=e.dataTransfer;if(!t&&!t.files)return!1;var o=t.files;return t.dropEffect="copy",o.length<2?ajax_upload(o[0]):ajax_uploads(o),!1}function ajax_upload(e){if(e.size>maxFileSize)alert("File size is bigger than 10MB");else{var t=new FormData;t.append("file",e),ajax_send(t,"is")}}function ajax_uploads(e){for(var t=0,o=0;o<e.length;o++)t+=e[o].size;if(t>maxFileSize)alert("Files size is bigger than 10MB");else{for(var r=new FormData,o=0;o<e.length;o++)r.append("multipartFiles",e[o]);ajax_send(r,"are")}}function ajax_get(e,t){var o=new XMLHttpRequest;t.hasClass("picture")&&o.addEventListener("progress",function(e){e.lengthComputable&&(0==notifDownload&&(setPartDwnldUpld("dwnld"),notifDownload=1),percentComplete=Math.ceil(e.loaded/e.total*100),optimizeSpeedColor())},!1),o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){t.hasClass("picture")&&void 0!=progress&&(progress.remove(),$(".download-info").remove());var e=window.URL||window.webkitURL;t.attr("src",e.createObjectURL(this.response)),setTimeout(function(){t.hasClass("picture")||t.css("transition","filter .2s ease-in, opacity .2s ease-in, transform .2s ease-in, box-shadow .2s ease-in"),t.css("transform","rotateX(0deg)"),t.hasClass("shadow")?t.css("boxShadow","0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)"):t.css("boxShadow","none"),t.css("opacity","1"),t.css("filter","blur(0px)"),clearInterval(optimizeInterval),percentComplete=0},100)}},o.open("GET",e),o.responseType="blob",o.send()}function ajax_send(e,t){$.ajax({url:"/upload/image"+("are"==t?"s":""),type:"PUT",data:e,cache:!1,processData:!1,contentType:!1,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload.addEventListener("progress",function(e){e.lengthComputable&&(0==notif&&(setPartDwnldUpld("upld"),$(".bold").hide(),$(".drag-info").hide(),$(".click-info").hide(),picture.hide(),$(".file").hide(),main.css("justify-content","center"),main.css("align-items","center"),main.css("flex-direction","column"),$(".upload-info").show(),notif=1),2!=notif&&(percentComplete=Math.ceil(e.loaded/e.total*100),optimizeSpeedColor(),100==percentComplete&&(notif=2,setTimeout(function(){0==wasError?($(".upload-info").remove(),progress.remove(),main.append($("<div/>",{class:"flowspinner"}),$("<span/>",{class:"optimize-info"}).text("Optimization"))):wasError=0},1e3))))},!1),e},success:function(e){window.location.href=e},error:function(){clearInterval(optimizeInterval),percentComplete=0,notif=0,wasError=1,progress.remove(),$(".optimize-info").remove(),$(".flowspinner").remove(),$(".upload-info").remove(),$(".bold").show(),picture.show(),$(".file").show(),alert("Something was wrong, check the type of file.")}})}function setPartDwnldUpld(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttributeNS(null,"id","progress-percent"),t.setAttributeNS(null,"width","200"),t.setAttributeNS(null,"height","200");var o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.setAttributeNS(null,"id","circle"),o.setAttributeNS(null,"r","90"),o.setAttributeNS(null,"cx","100"),o.setAttributeNS(null,"cy","100");var r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttributeNS(null,"id","percent"),r.setAttributeNS(null,"x","100"),r.setAttributeNS(null,"y","-85"),main.append(t,$("<span/>",{class:"dwnld"==e?"download-info":"upload-info"}).text("dwnld"==e?"Downloading":"Uploading")),(progress=$("#progress-percent")).append(o,r),(percent=$("#percent")).text("0%"),pie=$("#circle"),pieOfValue=pie.css("strokeDasharray").split(" ")[1],dash="x"==pieOfValue.charAt(pieOfValue.length-1)?pieOfValue.substring(0,pieOfValue.length-2):pieOfValue}function optimizeSpeedColor(){void 0==optimizeInterval&&(optimizeInterval=setInterval(function(){console.log(percentComplete+" // "+prevPercent),percentComplete-prevPercent>=25?(pie.css("transition","stroke-dasharray .01s ease-in, stroke .01s ease-in"),percent.css("transition","fill .01s ease-in")):percentComplete-prevPercent>=10?(pie.css("transition","stroke-dasharray .1s ease-in, stroke .1s ease-in"),percent.css("transition","fill .1s ease-in")):percentComplete-prevPercent>=5?(pie.css("transition","stroke-dasharray .2s ease-in, stroke .2s ease-in"),percent.css("transition","fill .2s ease-in")):(pie.css("transition","stroke-dasharray .3s ease-in, stroke .3s ease-in"),percent.css("transition","fill .3s ease-in")),prevPercent=percentComplete},1e3)),color=percentComplete>90?0:percentComplete>75?1:percentComplete>50?2:percentComplete>25?3:4,pie.css("stroke",colors[color]),percent.css("fill",colors[color]),pie.css("strokeDasharray",percentComplete*dash/100+" "+dash),percent.text(percentComplete+"%")}var notification,main,picture,dropZone,maxFileSize;$(document).ready(function(e){if(notification=$(".notification"),main=$(".main"),picture=$(".picture"),dropZone=e("#dropZone"),maxFileSize=1e7,void 0==typeof window.FileReader&&(dropZone.clearData(),dropZone.text("Not supported drag files! Sorry, but I still believe, you make update your browser :)")),notification.css("display","block"),picture.length)ajax_get("/img/"+picture.data("key"),picture);else if($(".file").length)for(var t=$(".file > .image-folder"),o=0;o<t.length;o++)ajax_get("/img_min/"+t[o].dataset.key,$(t[o]))});var notif=0,wasError=0,notifDownload=0,prevPercent=0,colors=["#2ECC71","#1ABC9C","#F39C12","#E67E22","#E74C3C"],color=0,percent,pie,progress,pieOfValue,dash,percentComplete=0,optimizeInterval;