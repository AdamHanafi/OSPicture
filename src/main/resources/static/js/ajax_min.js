var picture,optimizeInterval,fileElem;function copyToClipboard(a){var b=$("<input>");$("body").append(b),b.val(a).select(),document.execCommand("copy"),b.remove()}function clearOthers(){"0px"===main.css("top")&&main.css("background-color","black"),$(".flowspinner").remove(),$(".bold").show(),picture&&picture.show(),fileElem&&fileElem.show(),alert("Something was wrong, check the type of file.")}function processProgress(){var a=$.ajaxSettings.xhr();return a.upload.addEventListener("progress",function(b){if(b.lengthComputable){if(!$("#progress-percent").length){"0px"===main.css("top")&&main.css("background-color","#34495E");var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttributeNS(null,"id","progress-percent"),c.setAttributeNS(null,"width","200"),c.setAttributeNS(null,"height","200");var d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.setAttributeNS(null,"id","circle"),d.setAttributeNS(null,"r","90"),d.setAttributeNS(null,"cx","100"),d.setAttributeNS(null,"cy","100");var f=document.createElementNS("http://www.w3.org/2000/svg","text");f.setAttributeNS(null,"id","percent"),f.setAttributeNS(null,"x","100"),f.setAttributeNS(null,"y","-85"),main.append(c,$("<span/>",{"class":"upload-info"}).text("Uploading")),progress=$("#progress-percent"),progress.append(d,f),percent=$("#percent"),percent.text("0%"),pie=$("#circle"),pieOfValue=pie.css("strokeDasharray").split(" ")[1],dash="x"===pieOfValue.charAt(pieOfValue.length-1)?pieOfValue.substring(0,pieOfValue.length-2):pieOfValue,$(".bold").hide(),$(".drag-info").hide(),$(".click-info").hide(),picture&&picture.hide(),fileElem&&fileElem.hide(),main.css("justify-content","center"),main.css("align-items","center"),main.css("flex-direction","column"),$(".upload-info").show(),notif=1}2!=notif&&(percentComplete=Math.ceil(100*(b.loaded/b.total)),optimizeInterval&&(optimizeInterval=setInterval(function(){25<=percentComplete-prevPercent?(pie.css("transition","stroke-dasharray .01s ease-in, stroke .01s ease-in"),percent.css("transition","fill .01s ease-in")):10<=percentComplete-prevPercent?(pie.css("transition","stroke-dasharray .1s ease-in, stroke .1s ease-in"),percent.css("transition","fill .1s ease-in")):5<=percentComplete-prevPercent?(pie.css("transition","stroke-dasharray .2s ease-in, stroke .2s ease-in"),percent.css("transition","fill .2s ease-in")):(pie.css("transition","stroke-dasharray .3s ease-in, stroke .3s ease-in"),percent.css("transition","fill .3s ease-in")),prevPercent=percentComplete},1e3)),color=90<percentComplete?0:75<percentComplete?1:50<percentComplete?2:25<percentComplete?3:4,pie.css("stroke",colors[color]),percent.css("fill",colors[color]),pie.css("strokeDasharray",percentComplete*dash/100+" "+dash),percent.text(percentComplete+"%"),100===percentComplete&&(notif=2,setTimeout(function(){0===wasError?($(".upload-info").remove(),progress.remove(),main.append($("<div/>",{"class":"flowspinner"}),$("<span/>",{"class":"optimize-info"}).text("Optimization"))):wasError=0},1e3)))}},!1),a}function processFail(){clearInterval(optimizeInterval),percentComplete=0,notif=0,wasError=1,progress.remove(),$(".optimize-info").remove(),$(".upload-info").remove(),clearOthers()}function ajaxSend(a){$.ajax({url:"/upload/image",type:"PUT",data:a,cache:!1,processData:!1,contentType:!1,xhr(){return processProgress()},success(b){window.location.href=site+b},error(){processFail()}})}function ajaxSends(a,b){$.ajax({url:"/upload/images?keys="+b,type:"PUT",data:a,cache:!1,processData:!1,contentType:!1,xhr(){return processProgress()},success(c){window.location.href=site+c},error(){processFail()}})}function ajaxUpload(a){a&&(a.size>maxFileSize?alert("File size is bigger than 10MB"):checkChecksum(a))}function ajaxUploads(a){var c,b=0;for(c=0;c<a.length;c++)b+=a[c].size;if(b>maxFileSize)alert("Files size is bigger than 10MB");else for(c=0;c<a.length;c++)checkChecksum(a[c],c===a.length-1?"are1":"are",a.length)}var percent,pie,progress,pieOfValue,dash,notif=0,wasError=0,prevPercent=0,colors=["#2ECC71","#1ABC9C","#F39C12","#E67E22","#E74C3C"],color=0,percentComplete=0;function ajaxGetInfo(a,b){isProcessing||(isProcessing=!0,$.ajax({url:"/info_image/"+mainReady.data("folder")+"/"+a,type:"GET",success(c){"left"===b?actionDoLeft(c):actionDoRight(c)}}))}function ajaxSendURL(a){picture&&picture.hide(),$(".bold").hide(),$(".drag-info").hide(),$(".click-info").hide(),fileElem&&fileElem.hide(),"0px"===main.css("top")&&main.css("background-color","#34495E"),main.append($("<div/>",{"class":"flowspinner"})),$.ajax({url:"/upload?url="+a,type:"PUT",success(b){window.location.href=site+b},error(){clearOthers()}})}