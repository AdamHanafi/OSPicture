function settingPicture(){mainReady.css("top","0"),mainReady.css("bottom","0"),$(".main").length<2?(mainReady.css("left","0"),mainReady.css("right","0")):"left"==typeAnimation?(mainReady.css("left","-100%"),mainReady.css("right","100%")):(mainReady.css("left","100%"),mainReady.css("right","-100%")),screen.width>480&&footer.css("bottom","-44px"),footer.css("background-color","rgba(0,0,0,0.7)"),$("body").css("background-color","black"),$("body").css("transition","background-color .2s")}function addListenerDownload(t,i){var e="picture"==i;e&&(resolution=$("#resolution").text().split("x"),setTimeout(function(){void 0==picture?0==notifDownload&&(mainReady.append($("<div/>",{class:"flowspinner"}),$("<span/>",{class:"download-info"}).text("Downloading")),notifDownload=1):$(".main").length>1&&($(".picture").first().css("filter","brightness(40%)"),$(".main").first().append($("<div/>",{class:"flowspinner"})),notifDownload=1)},400));var n=$("<img />",{class:i,alt:"Image"}).attr("src",(e?"/img/":"/img_min/")+t.data("key")+"."+t.data("format")).on("load",function(){this.complete&&void 0!==this.naturalWidth&&0!=this.naturalWidth?(e&&(notifDownload=1,$(".flowspinner").length&&($(".flowspinner").remove(),$(".download-info").remove())),t.append(n[0]),e&&(picture=$(".picture").last(),calculateView(0,1),$(".main").length>1&&"0px"!=mainReady.css("top")&&("right"==typeAnimation?(mainReady.css("left","calc(100% + 25px)"),mainReady.css("right","calc(-100% + 25px")):(mainReady.css("left","calc(-100% + 25px)"),mainReady.css("right","calc(100% + 25px"))),"0px"!=mainReady.css("top")&&($(".footer").css("bottom",$(".arrow-box").length?"-44px":"0px"),$(".footer").css("background-color","transparent"))),setTimeout(function(){$(".main").length<2&&(n[0].style.transition=e?transitSetting+",  max-width .2s ease-in, max-height .2s ease-in":"filter .2s ease-in, "+transitSetting),n[0].style.transform="rotateX(0deg)",n[0].style.boxShadow="none",n[0].style.opacity="1",e&&(setTimeout(function(){mainReady.css("transition","top .2s, bottom .2s, left .2s, right .2s"),n[0].style.transition=transitSetting+",  max-width .2s ease-in, max-height .2s ease-in",$(".main").length>1?("left"==typeAnimation?($(".main")[0].style.left="100%",$(".main")[0].style.right="-100%"):($(".main")[0].style.left="-100%",$(".main")[0].style.right="100%"),"0px"==mainReady.css("top")?($("body").css("background-color","black"),mainReady.css("left","0px"),mainReady.css("right","0px")):($("body").css("background-color","#34495E"),mainReady.css("left","25px"),mainReady.css("right","25px")),setTimeout(function(){$(".main").first().remove(),isProcessing=!1,main=$(".main"),rotateDeg=0},200)):isProcessing=!1},40),$(window).resize(function(){calcViewRotateDeg()}))},20)):t.append($("<span />").text("Broken image"))})}function calculateView(t,i){if(isResolution=resolution[t]>resolution[i],window.innerWidth<=resolution[t]&&window.innerHeight<=resolution[i]){var e=window.innerWidth>window.innerHeight,n=(resolution[t]/resolution[i]+"").substring(0,3),o=n==(window.innerWidth/window.innerHeight+"").substring(0,3);if(isResolution&&e&&((screen.width/screen.height+"").substring(0,3)==n&&screen.width-window.innerWidth<=211&&screen.height-window.innerHeight<=211||o))return settingPicture(),resolution[0]>resolution[1]&&0==t?(picture.css("max-width","100%"),picture.css("max-height","inherit")):(picture.css("max-width","inherit"),picture.css("max-height",main.width()+(main.width()==picture.css("max-height")?0:"0px"==main.css("left")?0:50))),!0;if(!isResolution&&!e&&o)return settingPicture(),0==t?(picture.css("max-width","inherit"),picture.css("max-height","100%")):(picture.css("max-width",main.height()+(screen.width<480?395:main.height()==picture.css("max-width")?0:"0px"==main.css("left")?0:140)),picture.css("max-height","inherit")),!0}return!1}function actionDoLeft(t){typeAnimation="left",settingNewPicture(t)}function actionDoRight(t){typeAnimation="right",settingNewPicture(t)}function settingNewPicture(t){var i=$("<div>",{class:"main"});mainReady.after(i),mainReady=$(".main").last(),window.history.pushState("html","OSPicture - Hosting the images","/image/"+t.key),mainReady.data("key",t.key),mainReady.data("format",t.format),$(".info").css("bottom","-44px"),setTimeout(function(){$("#resolution").text(t.resolution),$("#file-info").text(t.name),$("#file-info").click(function(){actionCopyToClipboard(t.name)}),$("#size").text(t.size),$("#format").text("true"==t.isOctetStream?"octet-stream":t.format),addListenerDownload(mainReady,"picture"),setTimeout(function(){$(".info").css("bottom","10px")},20)},200),$("#download-picture").attr("href","/img/"+t.key),$("#download-picture").attr("download",t.name+("true"==t.isOctetStream?"":".")+("true"==t.isOctetStream?"":t.format)),$("#direct-link").click(function(){actionCopyToClipboard(site+"img/"+t.key+"."+t.format)}),$("#html-link").click(function(){actionCopyToClipboard("<a href='"+window.location.href+"'><img src='"+site+"img/"+t.key+"."+t.format+"' alt='Image from OSPicture'></a>")}),$("#bbcode-link").click(function(){actionCopyToClipboard("[url="+window.location.href+"][img]"+site+"img/"+t.key+"."+t.format+"[/img][/url]")}),$("#px200").attr("href","/"+t.px200Path),$("#px500").attr("href","/"+t.px500Path),mainReady.data("left",t.folderLeft),mainReady.data("right",t.folderRight)}var notifDownload=0,rotateDeg=0,resolution,mainReady=$(".main"),transitSetting="opacity .05s, transform .2s ease-in, box-shadow .2s ease-in",isResolution,footer=$(".footer"),isBlack,typeAnimation,isProcessing=!1;notification=$(".notification"),notification.css("display","block"),setTimeout(function(){if($(".arrow-box").length&&(screen.width<480?$(".footer").css("display","none"):$(".footer").css("bottom","-44px")),$("#download-picture").length)addListenerDownload(mainReady,"picture");else if($(".file").length)for(var t=$(".file"),i=0;i<t.length;i++)addListenerDownload($(t[i]),"image-folder")},20),""!=mainReady.data("left")&&(document.onkeydown=function(t){37==(t=t||window.event).keyCode?$("#arrow-left").click():39==t.keyCode&&$("#arrow-right").click()});