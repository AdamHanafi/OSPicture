function settingPicture(){mainReady.css("top","0"),mainReady.css("bottom","0"),$(".main").length<2?(mainReady.css("left","0"),mainReady.css("right","0")):"left"===typeAnimation?(mainReady.css("left","-100%"),mainReady.css("right","100%")):(mainReady.css("left","100%"),mainReady.css("right","-100%")),screen.width>480&&footer.css("bottom","-44px"),footer.css("background-color","rgba(0,0,0,0.7)"),body.css("background-color","black"),body.css("transition","background-color .2s")}function setPicture(t,e){picture.css("max-width","100%"===t?"100%":"inherit"===t?"inherit":main.height()+(screen.width<480?395:main.height()===picture.css("max-width")?0:"0px"===main.css("left")?0:140)),picture.css("max-height","100%"===e?"100%":"inherit"===e?"inherit":main.width()+(main.width()===picture.css("max-height")?0:"0px"===main.css("left")?0:50))}function calculateView(t,e){if(isResolution=resolution[t]>resolution[e],window.innerWidth<=resolution[t]&&window.innerHeight<=resolution[e]){var i=window.innerWidth>window.innerHeight,n=(resolution[t]/resolution[e]+"").substring(0,3),o=n===(window.innerWidth/window.innerHeight+"").substring(0,3);if(isResolution&&i&&((screen.width/screen.height+"").substring(0,3)===n&&screen.width-window.innerWidth<=211&&screen.height-window.innerHeight<=211||o))return settingPicture(),resolution[0]>resolution[1]&&0===t?setPicture("100%","inherit"):setPicture("inherit","calc"),!0;if(!isResolution&&!i&&o)return settingPicture(),0===t?setPicture("inherit","calc"):setPicture("calc","inherit"),!0}return!1}function setMainReady(t,e){t.css("left","calc("+(e?"-":"+")+"100% + 25px)"),t.css("right","calc("+(e?"+":"-")+"100% + 25px")}function setMainReadyPx(t){body.css("background-color","25px"===t?"#34495E":"black"),mainReady.css("left",t),mainReady.css("right",t)}function addListenerDownload(t,e){var i="picture"===e;i&&(resolution=resolutionElem.text().split("x"),setTimeout(function(){void 0===picture?0===notifDownload&&(mainReady.append($("<div/>",{class:"flowspinner"}),$("<span/>",{class:"download-info"}).text("Downloading")),notifDownload=1):$(".main").length>1&&($(".picture").first().css("filter","brightness(40%)"),$(".main").first().append($("<div/>",{class:"flowspinner"})),notifDownload=1)},400));var n=$("<img />",{class:e,alt:"Image"}).attr("src",(i?"/img/":"/img_min/")+t.data("key")+"."+t.data("format")).on("load",function(){this.complete&&void 0!==this.naturalWidth&&0!==this.naturalWidth?(i&&(notifDownload=1,$(".flowspinner").length&&($(".flowspinner").remove(),$(".download-info").remove())),t.append(n[0]),i&&(picture=$(".picture").last(),calculateView(0,1),$(".main").length>1&&"0px"!==mainReady.css("top")&&("right"===typeAnimation?setMainReady(mainReady,"+"):setMainReady(mainReady,"-")),"0px"!==mainReady.css("top")&&(footer.css("bottom",$(".arrow-box").length?"-44px":"0px"),footer.css("background-color","transparent"))),setTimeout(function(){$(".main").length<2&&(n[0].style.transition=i?transitSetting+",  max-width .2s ease-in, max-height .2s ease-in":"filter .2s ease-in, "+transitSetting),n[0].style.transform="rotateX(0deg)",n[0].style.boxShadow="none",n[0].style.opacity="1",i&&(setTimeout(function(){mainReady.css("transition","top .2s, bottom .2s, left .2s, right .2s"),n[0].style.transition=transitSetting+",  max-width .2s ease-in, max-height .2s ease-in";var t=$(".main");t.length>1?("left"===typeAnimation?setMainReady($(t[0]),"+"):setMainReady($(t[0]),"-"),setMainReadyPx("0px"===mainReady.css("top")?"0px":"25px"),setTimeout(function(){$(t[0]).remove(),isProcessing=!1,main=$(".main"),rotateDeg=0},200)):isProcessing=!1},40),$(window).resize(function(){calcViewRotateDeg()}))},20)):t.append($("<span />").text("Broken image"))})}function settingNewPicture(t){var e=$("<div>",{class:"main"});mainReady.after(e),mainReady=$(".main").last(),window.history.pushState("html","OSPicture - Hosting the images","/image/"+t.key),mainReady.data("key",t.key),mainReady.data("format",t.format),infoElem.css("bottom","-44px"),setTimeout(function(){resolutionElem.text(t.resolution),fileInfoElem.text(t.name),fileInfoElem.click(function(){actionCopyToClipboard(t.name)}),sizeElem.text(t.size),formatElem.text("true"===t.isOctetStream?"octet-stream":t.format),addListenerDownload(mainReady,"picture"),setTimeout(function(){infoElem.css("bottom","10px")},20)},200),downloadPictureElem.attr("href","/img/"+t.key),downloadPictureElem.attr("download",t.name+("true"===t.isOctetStream?"":".")+("true"===t.isOctetStream?"":t.format)),directLinkElem.click(function(){actionCopyToClipboard(site+"img/"+t.key+"."+t.format)}),htmlLinkElem.click(function(){actionCopyToClipboard('<a href="'+window.location.href+'"><img src="'+site+"img/"+t.key+"."+t.format+'" alt="Image from OSPicture"></a>')}),bbcodeLinkElem.click(function(){actionCopyToClipboard("[url="+window.location.href+"][img]"+site+"img/"+t.key+"."+t.format+"[/img][/url]")}),px200ELem.attr("href","/"+t.px200Path),px500Elem.attr("href","/"+t.px500Path),mainReady.data("left",t.folderLeft),mainReady.data("right",t.folderRight)}function actionDoLeft(t){typeAnimation="left",settingNewPicture(t)}function actionDoRight(t){typeAnimation="right",settingNewPicture(t)}var notifDownload=0,rotateDeg=0,resolution,mainReady=$(".main"),transitSetting="opacity .05s, transform .2s ease-in, box-shadow .2s ease-in",isResolution,body=$("body"),footer=$(".footer"),typeAnimation,isProcessing=!1,resolutionElem=$("#resolution"),downloadPictureElem=$("#download-picture"),fileElem=$(".file"),arrowLeftElem=$("#arrow-left"),arrowRightElem=$("#arrow-right"),fileInfoElem=$("#file-info"),sizeElem=$("#size"),formatElem=$("#format"),infoElem=$(".info"),directLinkElem=$("#direct-link"),htmlLinkElem=$("#html-link"),bbcodeLinkElem=$("#bbcode-link"),px200ELem=$("#px200"),px500Elem=$("#px500"),notification=$(".notification");notification.css("display","block"),setTimeout(function(){if($(".arrow-box").length&&(screen.width<480?$(".footer").css("display","none"):$(".footer").css("bottom","-44px")),downloadPictureElem.length)addListenerDownload(mainReady,"picture");else if(fileElem.length)for(var t=0;t<fileElem.length;t++)addListenerDownload($(fileElem[t]),"image-folder")},20),""!==mainReady.data("left")&&(document.onkeydown=function(t){37===(t=t||window.event).keyCode?arrowLeftElem.click():39===t.keyCode&&arrowRightElem.click()});